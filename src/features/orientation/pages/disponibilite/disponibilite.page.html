<div class="h-100 d-flex pt-5">
  <div class="w-100 my-auto">
    <h1 class="h2 text-center fw-bold mt-5">
      <span class="text-primary">Quand</span>
      serez-vous disponible&nbsp;?
    </h1>
    <h5 class="text-center mb-4 mx-5 text-muted">
      Vous pouvez renseigner des créneaux en cherchant des structures ouverte à un horaire précis, ou simplement regarder les
      structures ouvertes actuellement pour les contacter par téléphone
    </h5>
    <form [formGroup]="orientationLayout.filterForm">
      <div class="accordion" id="accordionDisponibilite">
        <div class="accordion-item mb-3">
          <h2 class="accordion-header" id="headingDatePrecise">
            <button
              type="button"
              class="accordion-button orientation-btn p-3 collapsed"
              aria-controls="collapseDatePrecise"
              [class.collapsed]="collapseDatePrecise.isCollapsed$ | async"
              [attr.aria-expanded]="collapseDatePrecise.isExpanded$ | async"
              (click)="collapseDatePrecise.toggle()">
              <i class="ri-calendar-todo-line ri-xl ri-fw ri-space me-3 bg-primary text-light rounded-circle"></i>
              <b class="orientation-btn-label">Je cherche des structures ouvertes à une date précise</b>
            </button>
          </h2>
          <app-collapse
            #collapseDatePrecise
            id="collapseDatePrecise"
            [state]="hasOpeningsHours ? 'expanded' : 'collapsed'"
            aria-labelledby="headingDatePrecise">
            <div class="accordion-body bg-light py-4">
              <app-opening-hours-form
                #openingHoursForm
                (selectOpeningHours)="onSelectOpeningHours($event)"
                [openingHours]="orientationLayout.filterForm.controls['horaires_ouverture'].value"></app-opening-hours-form>
              <div class="text-center mt-4">
                <button
                  type="button"
                  class="btn btn-secondary m-3"
                  (click)="openingHoursForm.onResetOpeningHoursForm(); collapseDatePrecise.toggle()">
                  Annuler
                  <i class="ri-close-line align-bottom"></i>
                </button>
                <app-display-on-map-link
                  buttonStyle="primary"
                  [cartographieFeature]="features.get('cartographie')"
                  [lieuxMediationNumeriqueCount]="(orientationLayout.lieuxMediationNumeriqueCount$ | async) ?? 0"
                  [queryParams]="route.queryParams">
                  Afficher les résultats
                </app-display-on-map-link>
              </div>
            </div>
          </app-collapse>
        </div>
      </div>
    </form>
    <ng-container *ngIf="collapseDatePrecise.isCollapsed$ | async">
      <app-text-separator class="px-3 my-5">OU</app-text-separator>
      <div class="text-center">
        <ng-container *ngIf="features.get('cartographie') as cartographie">
          <a
            *ngIf="cartographie.active"
            class="accordion-button p-3 bg-light text-decoration-none"
            [class.disabled]="((orientationLayout.lieuxMediationNumeriqueCount$ | async) ?? 0) === 0"
            [routerLink]="['/','cartographie']"
            queryParamsHandling="preserve">
            <i class="ri-road-map-line ri-xl ri-fw ri-space me-3 bg-primary text-light rounded-circle"></i>
            <b class="accordion-button-label">J’affiche toutes les structures correspondant à ma recherche</b>
            <i class="ri-arrow-right-s-line ri-2x text-muted ms-auto position-absolute me-3 end-0"></i>
          </a>
          <a
            *ngIf="!cartographie.active && cartographie.url"
            class="accordion-button p-3 bg-light text-decoration-none"
            [class.disabled]="((orientationLayout.lieuxMediationNumeriqueCount$ | async) ?? 0) === 0"
            [href]="cartographie.url + '?' + toQueryString($any(route.queryParams | async))"
            rel="keep-params">
            <i class="ri-road-map-line ri-xl ri-fw ri-space me-3 bg-primary text-light rounded-circle"></i>
            <b class="accordion-button-label">J’affiche toutes les structures correspondant à ma recherche</b>
            <i class="ri-arrow-right-s-line ri-xl ri-fw ri-space float-end"></i>
          </a>
        </ng-container>
      </div>
    </ng-container>
  </div>
</div>
