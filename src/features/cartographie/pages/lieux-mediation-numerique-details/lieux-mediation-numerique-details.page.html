<div
  *ngIf="(lieuMediationNumerique$ | async) as lieuMediationNumerique; else lieuNotFound"
  tabindex="-1"
  class="h-100 overflow-auto border-end">
  <app-lieux-mediation-numerique-details-print
    [lieuMediationNumerique]="lieuMediationNumerique"
    [filters]="(filters$ | async) ?? undefined"
    [orientationSheetForm]="(orientationSheetForm$ | async) ?? undefined"></app-lieux-mediation-numerique-details-print>
  <app-lieux-mediation-numerique-details
    (print)="onPrint($event)"
    (sendEmailTo)="onSendEmailTo($event)"
    (reportAnError)="onReportAnError(lieuMediationNumerique)"
    (closeDetails)="onCloseDetails($event)"
    (showLabel)="onShowLabel($event)"
    (showLabelInvokingContext)="labelModal.toggle($event)"
    [lieuMediationNumerique]="lieuMediationNumerique"
    [filters]="(filters$ | async) ?? undefined"></app-lieux-mediation-numerique-details>
</div>
<ng-template #lieuNotFound>
  <div class="d-flex flex-column justify-content-between h-100">
    <div class="d-flex align-items-center bg-primary text-bg-dark p-3">
      <div class="d-flex flex-grow-1 p-3">
        <i class="ri-4x ri-xl ri-close-circle-line me-3 mt-1" aria-hidden="true"></i>
        <div>
          <p class="m-0">Erreur</p>
          <h2 class="bg-primary">
            <b>Lieu introuvable</b>
          </h2>
        </div>
      </div>
      <button
        type="button"
        class="btn-close btn-close-white opacity-100 small mb-0 me-2"
        aria-label="Revenir à la liste des régions"
        (click)="onCloseNoLieuFound()"></button>
    </div>
    <div class="text-center p-3">
      <img *ngIf="brandConfiguration.logo; else brandLogo" class="mb-5 w-50" [src]="brandConfiguration.logo" alt="" />
      <ng-template #brandLogo>
        <img *ngIf="brandConfiguration.logoAvecTexte" class="mb-5 w-50" [src]="brandConfiguration.logoAvecTexte" alt="" />
      </ng-template>
      <h3 class="mb-5 fw-bold">
        Ce lieu
        <br />
        <span class="text-primary">n’est plus disponible</span>
      </h3>
      <div>
        <p>Nous sommes désolés, ce lieu n'existe pas ou n'existe plus !</p>
        <p>
          Vous pouvez rechercher d'autres lieux en naviguant sur la carte
          <br />
          ou revenir à la page d'accueil et effectuer un parcours d'orientation.
        </p>
      </div>
    </div>
    <div class="bg-light text-center py-5">
      <a class="btn btn-secondary" routerLink="/orientation" queryParamsHandling="preserve">
        Revenir à la page d'accueil
        <i class="ri-arrow-right-s-line" aria-hidden="true"></i>
      </a>
    </div>
  </div>
</ng-template>
<app-modal #labelModal heading="Informations label" icon="ri-information-line" closeLabel="Retour à la carte">
  <ng-container *ngIf="(labelToDisplay$ | async) as label">
    <img
      [src]="assetsConfiguration.path + '/img/logo/labels/' + label.ref + '.svg'"
      [alt]="'Logo ' + label.nom"
      class="mb-3"
      style="width: 180px; max-height: 120px" />
    <h4 class="fw-bold text-primary">{{ label.nom }}</h4>
    <p class="mb-0 mt-3">{{ label.description }}</p>
    <div class="my-3">
      <i *ngFor="let carracteristique of label.carracteristiques" class="badge rounded-pill text-bg-light fw-normal me-2">
        {{ carracteristique }}
      </i>
    </div>
    <span *ngIf="label.lieuxCount as lieuxCount" [ngPlural]="lieuxCount" class="rounded-5 bg-light py-1 px-3">
      <i class="ri-map-pin-5-line me-2" aria-hidden="true"></i>
      <ng-template ngPluralCase="=1">
        <b>1 lieu</b>
        utilise ce label
      </ng-template>
      <ng-template ngPluralCase="other">
        <b>{{ lieuxCount }} lieux</b>
        utilisent ce label
      </ng-template>
    </span>
  </ng-container>
  <a
    slot="footer"
    *ngIf="(labelToDisplay$ | async)?.url as href"
    [href]="href"
    target="_blank"
    rel="noopener noreferrer"
    class="btn btn-primary"
    (click)="labelModal.close()">
    Accéder au site
    <i class="ri-external-link-line" aria-hidden="true"></i>
  </a>
</app-modal>
